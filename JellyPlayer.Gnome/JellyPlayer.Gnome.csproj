<Project Sdk="Microsoft.NET.Sdk">

    <PropertyGroup>
        <OutputType>Exe</OutputType>
        <TargetFramework>net9.0</TargetFramework>
        <ImplicitUsings>enable</ImplicitUsings>
        <Nullable>enable</Nullable>
        <Company>JellyPlayer.Gnome</Company>
        <Product>JellyPlayer.Gnome</Product>
        <AssemblyName>JellyPlayer</AssemblyName>
    </PropertyGroup>

    <ItemGroup>
      <PackageReference Include="GirCore.Adw-1" Version="0.6.3" />
      <PackageReference Include="GirCore.Gdk-4.0" Version="0.6.3" />
      <PackageReference Include="GirCore.GdkPixbuf-2.0" Version="0.6.3" />
      <PackageReference Include="GirCore.Gio-2.0" Version="0.6.3" />
      <PackageReference Include="GirCore.GLib-2.0" Version="0.6.3" />
      <PackageReference Include="GirCore.GObject-2.0.Integration" Version="0.6.3" />
      <PackageReference Include="Microsoft.Extensions.DependencyInjection" Version="9.0.4" />
      <PackageReference Include="Microsoft.Extensions.Http" Version="9.0.4" />
    </ItemGroup>

    <ItemGroup>
      <EmbeddedResource Include="Resources\jellyplayer-icon.svg" />
      <None Remove="Blueprints\window.blp" />
      <EmbeddedResource Include="Blueprints\album_grid_item.ui" />
      <EmbeddedResource Include="Blueprints\window.ui" />
      <None Remove="Blueprints\album_row.ui" />
      <None Remove="Blueprints\album_details.ui" />
      <None Remove="Blueprints\preferences_dialog.ui" />
      <None Remove="Blueprints\album_dialog.ui" />
      <None Remove="Blueprints\player.ui" />
      <EmbeddedResource Include="Blueprints\player.ui" />
      <None Remove="Blueprints\track_row.ui.xml" />
      <EmbeddedResource Include="Blueprints\track_row.ui" />
      <None Remove="Blueprints\album.ui" />
      <EmbeddedResource Include="Blueprints\album.ui" />
      <None Remove="Blueprints\preferences.ui" />
      <EmbeddedResource Include="Blueprints\preferences.ui" />
      <None Remove="Blueprints\album_list.ui" />
      <EmbeddedResource Include="Blueprints\album_list.ui" />
      <None Remove="Blueprints\album_list_item.ui" />
      <EmbeddedResource Include="Blueprints\album_list_item.ui" />
      <None Remove="Blueprints\lyrics.ui" />
      <EmbeddedResource Include="Blueprints\lyrics.ui" />
      <None Remove="Blueprints\search.ui" />
      <EmbeddedResource Include="Blueprints\search.ui" />
      <None Remove="Blueprints\search_list_item.ui" />
      <None Update="Resources\org.bacmanni.jellyplayer.css">
        <CopyToOutputDirectory>Always</CopyToOutputDirectory>
      </None>
      <None Update="Resources\org.bacmanni.jellyplayer-dark.css">
        <CopyToOutputDirectory>Always</CopyToOutputDirectory>
      </None>
      <None Update="Resources\org.bacmanni.jellyplayer.gresource.xml">
        <CopyToOutputDirectory>Always</CopyToOutputDirectory>
      </None>
      <None Remove="Blueprints\queue_list.ui" />
      <EmbeddedResource Include="Blueprints\queue_list.ui" />
      <None Remove="Blueprints\queue_list_item.ui" />
      <None Remove="Blueprints\wizard.ui" />
      <None Remove="Blueprints\queue_row.ui" />
      <EmbeddedResource Include="Blueprints\queue_row.ui" />
      <None Remove="Blueprints\startup.ui" />
      <EmbeddedResource Include="Blueprints\startup.ui" />
      <None Remove="Blueprints\search_row.ui" />
      <EmbeddedResource Include="Blueprints\search_row.ui" />
      <None Remove="Resources\org.bacmanni.jellyplayer.gresource" />
      <None Remove="Blueprints\login.ui" />
      <None Remove="Blueprints\account.ui" />
      <EmbeddedResource Include="Blueprints\account.ui" />
      <None Remove="Blueprints\entry_loaded.ui" />
      <None Remove="Blueprints\preferences_alert.ui" />
      <EmbeddedResource Include="Blueprints\preferences_alert.ui" />
      <None Remove="Blueprints\playlist.ui" />
      <EmbeddedResource Include="Blueprints\playlist.ui" />
    </ItemGroup>

    <ItemGroup>
      <ProjectReference Include="..\JellyPlayer.Shared\JellyPlayer.Shared.csproj" />
    </ItemGroup>

    <ItemGroup>
      <EmbeddedResource Include="Blueprints\login.ui" />
    </ItemGroup>

    <Target Name="PreBuild" BeforeTargets="PreBuildEvent">
        <Exec Command="echo Compiling gresources" />
        <Exec Command="glib-compile-resources --sourcedir ./Resources ./Resources/org.bacmanni.jellyplayer.gresource.xml --target=$(OutDir)/org.bacmanni.jellyplayer.gresource" />
    </Target>
    
    <Target Name="PostPublish" AfterTargets="Publish">
        <Exec Command="echo Copy resource" />
        <Exec Command="cp $(OutDir)/org.bacmanni.jellyplayer.gresource $(PublishDir)/org.bacmanni.jellyplayer.gresource" />
    </Target>
</Project>
